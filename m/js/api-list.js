(function(window){"use strict";if(typeof window!=='object')return;if(typeof window.clouda==='undefined'){window.Blend=window.clouda={}};var b=window.clouda;
"function"!=typeof clouda.lightapp&&(clouda.lightapp=function(a,b){clouda.lightapp.ak=a,"function"==typeof b&&b()}),"function"!=typeof clouda.lightInit&&(clouda.lightInit=function(a,b){clouda.lightapp.ak=a.ak,"function"==typeof b&&b()}),clouda.STATUS={SUCCESS:0,SYSTEM_FAILURE:-3,USER_CANCELED:-2},clouda.RUNTIMES={WEB:0,KUANG:1,NUWA:2},clouda.PLATFORMS={ANDROID:1,IOS:2,OTHER:0},function(){if(clouda.RUNTIME="undefined"!=typeof BLightApp?clouda.RUNTIMES.KUANG:navigator.userAgent.match(/BaiduLightAppRuntime/i)?clouda.RUNTIMES.NUWA:clouda.RUNTIMES.WEB,clouda.PLATFORM=navigator.userAgent.match(/android/i)?clouda.PLATFORMS.ANDROID:navigator.userAgent.match(/(iphone)|(ipad)/i)?clouda.PLATFORMS.IOS:clouda.PLATFORMS.OTHER,navigator.userAgent.match(/baiduboxapp\/([\d.-_]*)/i)){var a=navigator.userAgent.match(/baiduboxapp\/([\d.-_]*)/i)[1];a.match(/[1-9]\.[^_]*/)&&(a=a.match(/[1-9]\.[^_]*/)[0]),clouda.PLATFORM===clouda.PLATFORMS.IOS&&(a=a.split(".").reverse().join(".")),clouda.RUNTIME_VERSION=a}else clouda.RUNTIME_VERSION="0"}();var ErrCode={UNKNOW_CALLBACK:-10,UNKNOW_INPUT:-99,SYSTEM_FAILURE:-3,USER_CANCELED:-2,AK_UNDEFINED:-4,RT_GETERROR:5,EXEC_ERROR:-5,NOT_FINISH:-98,BROWSER_NOT_SUPPORT:-97,ACC_GET_ERR:6,LOC_GET_ERR:7,CAP_GET_ERR:8,CONTACT_FIND_ERR:9,GLO_ERR:10,REACH_ERR:11,MEDIA_ERR:12,CPS_ERROR:13,BTY_ERROR:14,QR_ERR:15,FS_ERR:16,BTY_ERR:17,CONNECT_ERROR:18,SCREEN_ERROR:19,FR_ERROR:20,PUSH_ERR:21,GYRO_ERR:22,MAP_ERROR:23,LOGIN_ERROR:24,PCS_ERROR:25,DEVICE_ERR:26,PAY_ERROR:27,APP_ERROR:28},errorMessage={0:"成功","-10":"接口返回不符合预期","-2":"用户取消","-3":"接口的运行错误。","-4":"错误，您需要在调用api前设置ak。 clouda.lightapp(your_ak_here);","-5":"执行接口出错。","-98":"接口未提供。","-99":"接口输入不符合预期。",5:"接口的运行环境准备中出错。"},runtimeError=function(a,b,c){if(clouda.RUNTIME===clouda.RUNTIMES.WEB&&clouda.PLATFORM===clouda.PLATFORMS.ANDROID)return void clouda.lib.moplus.openApp();0>a&&(b=a),"object"==typeof c&&"function"==typeof c.onfail&&c.onfail(b);try{throw new Error}catch(d){var e=d.stack.split("\n"),f=errorMessage[a];if(!f)for(var g in ErrCode)if(ErrCode[g]===a){f=a+":"+g;break}console.error(f+"! "+(b?"app错误信息"+JSON.stringify(b):"")+e[2].replace(/\s*/,""))}},kuangstack=[],stackn=0,kuangForReady=function(functionname,argus){1!=clouda.STATUS.SUCCESS&&0===stackn?kuangstack.push({func:functionname,arg:argus}):eval(functionname).apply(null,argus)},BLightClass=function(){return function(a){return function(){a.exec.apply(a,arguments)}}(this)},emptyfunc=function(){};BLightClass.prototype.exec=function(){for(var a,b=arguments,c=Array.prototype.shift.apply(b),d=0,e=b.length;e>d;d++)"function"==typeof b[d]&&("function"==typeof b[d+1]?(a=clouda.lib.utils.regcallback(b[d],b[d+1]),b[d+1]=a.f):a=clouda.lib.utils.regcallback(b[d],emptyfunc),b[d]=a.s);1!=clouda.STATUS.SUCCESS&&0===stackn?kuangstack.push({func:"BLightApp."+c,arg:b}):BLightApp[c].apply(BLightApp,b)};var cloudaBLight=new BLightClass,DelegateClass=function(a,b,c){return this.module=a,this.submodule=b,this.func=c,function(a){return function(){a.exec.apply(a,arguments)}}(this)};DelegateClass.prototype.exec=function(){var a=arguments,b=this;installPlugin(this.module,function(c){try{b.func?c[b.submodule][b.func].apply(b,a):c[b.submodule].apply(b,a)}catch(d){var e;e=c?ErrCode.EXEC_ERROR:clouda.STATUS.SYSTEM_FAILURE,a.length&&"object"==typeof a[a.length-1]&&"function"==typeof a[a.length-1].onfail&&a[a.length-1].onfail(e),console.error(d.stack),b.error(e)}})},clouda.lightapp.error=DelegateClass.prototype.error=runtimeError;var beforeRuntimeReadyStack=[],timeoutid,triggerStack=function(){if(beforeRuntimeReadyStack.length){for(var i=0,len=beforeRuntimeReadyStack.length;len>i;i++)installPlugin.apply(void 0,beforeRuntimeReadyStack[i]);beforeRuntimeReadyStack.length=0}if(kuangstack.length){for(var j=0,jlen=kuangstack.length;jlen>j;j++)"undefined"!=typeof BLightApp?eval(kuangstack[j].func).apply(BLightApp,kuangstack[j].arg):eval(kuangstack[j].func).apply(void 0,kuangstack[j].arg);kuangstack.length=0}};timeoutid=setTimeout(function(){stackn=100,clouda.STATUS.SUCCESS||(clouda.STATUS.SUCCESS=1),triggerStack()},3e3),document.addEventListener("runtimeready",function(){clouda.STATUS.SUCCESS=1,"undefined"!=typeof BLightApp?clouda.RUNTIME=clouda.RUNTIMES.KUANG:clouda.RUNTIME!=clouda.RUNTIMES.KUANG&&(clouda.RUNTIME=clouda.RUNTIMES.NUWA),clearTimeout(timeoutid),triggerStack()});var regPlugins={},regCallbacks={},installPlugin=function(a,b,c){if(!clouda.lightapp.ak)return runtimeError(ErrCode.AK_UNDEFINED),console.error("错误，'"+a+"' clouda.lightapp(your_ak_here);"),!1;if(!clouda.STATUS.SUCCESS&&100>stackn)return void beforeRuntimeReadyStack.push([a,b]);if(!a)return!1;if("undefined"!=typeof regPlugins[a]&&regPlugins[a])return b(regPlugins[a]);if(Array.isArray(regCallbacks[a]))return regCallbacks[a].push(b);try{nuwa.pm.bindAk(clouda.lightapp.ak),regCallbacks[a]=[],regCallbacks[a].push(b),nuwa.pm.absorb(a,function(b){b.on("error",function(){throw new Error("RT_GETERROR")}),b.on("progress",function(b){console.log(a+" percentage = "+b)}),b.on("complete",function(){var b=nuwa.require(a);regPlugins[a]=b;for(var c=0,d=regCallbacks[a].length;d>c;c++)regCallbacks[a][c](b);delete regCallbacks[a]})})}catch(d){try{b(null)}catch(e){runtimeError(clouda.STATUS.SYSTEM_FAILURE,null,c),console.error(e.stack)}}return!1},count=0,uniqid=function(a){return a=a||"BlendUI",a+count++},define=function(a,b){var c,d;a.indexOf("/")>0?(c=clouda[a.split("/")[0]],d=a.split("/")[1],c[d]&&c[d].loadFlag?console.log('"'+d+'" has been already defined '):b.call(clouda.lightapp,c,clouda)):(c=clouda[a],b.call(clouda.lightapp,c,clouda))};clouda.device||(clouda.device={}),clouda.mbaas||(clouda.mbaas={}),clouda.lib||(clouda.lib={});define("lib",function(a){var b={},c="2264015";b.openApp=function(a,b,d){var e,f,g,h=0,i=location.href;if(d&&"object"==typeof d&&(f=d.tip||"",g=d.platform||"",h=d.startDownload),"string"==typeof d&&(f=d),a||confirm(f||"运行错误\n当前浏览器无法正常运行此页面，请使用手机百度\n点击确定立即启用")){if(1==h)return"ios"==g?void(location.href="itms-apps://itunes.apple.com/app/id382201985"):void(location.href="http://dl.ops.baidu.com/baidusearch_AndroidPhone_1006041p.apk");e="http://zhida.baidu.com/s?app_id="+(b||c)+"&target_url="+encodeURIComponent(i)+"&ref_id=invoker",location.href=e}},a.moplus=b});define("lib",function(a){function b(a){a.debug||(a.debug=a.info),l.log=a}var c,d=console,e=function(){};c=a.callbackProxy?a.callbackProxy:{successProxy:{},failProxy:{}};var f=100,g='function (randomId,result) {var sproxy = clouda.lib.callbackProxy.successProxy[randomId];if(typeof result === "string"){try{result = JSON.parse(result);}catch(e){console.error(e);}}if(sproxy){sproxy(result);}else{console.warn(randomId+" lost!");}}',h='function (randomId,result) {var fproxy = clouda.lib.callbackProxy.failProxy[randomId];if(typeof result === "string"){result = JSON.parse(result);}if(fproxy){fproxy(result);}else{console.warn(randomId+" lost!");}}',i={log:e,error:e,warn:e,info:e,debug:e,trace:e};Function.prototype.bind&&["error","warn"].forEach(function(a){i[a]=d[a].bind(d)});var j=!("undefined"==typeof a||!a.exports),k=!("undefined"==typeof document||!document.getElementById),l={slientLogger:i,setLogger:b,setDebugMode:function(a){b(a?d:i)},domReady:function(a){return/complete|loaded|interactive/.test(document.readyState)?void a():void document.addEventListener("DOMContentLoaded",function(){a()},!1)},extend:function(a){return a||(a={}),Array.prototype.slice.call(arguments,1).forEach(function(b){if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}),a},isArray:function(a){return Array.isArray?Array.isArray(a):"[object Array]"==Object.prototype.call(a)},isObject:function(a){return"[object Object]"==Object.prototype.toString.call(a)},isFunction:function(a){return"[object Function]"==Object.prototype.toString.call(a)},isNumber:function(a){return"[object Number]"==Object.prototype.toString.call(a)},isString:function(a){return"[object String]"==Object.prototype.toString.call(a)},isDefined:function(a){return"undefined"!=typeof a},isSimpleValue:function(a){return!(this.isObject(a)||this.isArray(a)||this.isFunction(a))},getUniqId:function(){return++f},randomInt:function(a,b){return Math.floor(Math.random()*(b-a+1))+a},inherit:function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},ajaxGet:function(a){var b=new window.XMLHttpRequest;return a.async!==!1&&(a.async=!0),a.async&&(b.onreadystatechange=function(){if(4==b.readyState){var c;b.status>=200&&b.status<300||0===b.status&&"file:"==location.protocol?(c=b.responseText,a.callback(c)):a.callback(b.responseText)}}),b.open("GET",a.url,a.async),b.send(a.query||""),a.async?void 0:200===b.status?b.responseText:!1},trim:function(a){return a?a.trim?a.trim():a.replace(/^\s+|\s+$/gm,""):""},trigger:function(a,b,c){if(!a)return void this.log.error("emply element passed in");c=c||{};var d,e={bubbles:!0,cancelable:!0,detail:c};if("undefined"!=typeof CustomEvent)d=new CustomEvent(b,e),a.dispatchEvent(d);else try{d=document.createEvent("CustomEvent"),d.initCustomEvent(b,!0,!0,c),a.dispatchEvent(d)}catch(f){this.log.error(f)}return!0},copy:function(a){var b;if(this.isArray(a)){b=[];for(var c=0,d=a.length;d>c;c++)b.push(this.copy(a[c],1));return b}if(this.isObject(a)){b={};for(var e in a)a.hasOwnProperty(e)&&!this.isSysOwnedFld(e)&&(b[e]=this.copy(a[e],1));return b}return a},isNodeEnv:function(){return j},isBrowserEnv:function(){return k},isPlainObject:function(a){if(!a||!this.isObject(a)||a.nodeType)return!1;if(a.constructor&&!a.hasOwnProperty("constructor")&&!a.constructor.prototype.hasOwnProperty("isPrototypeOf"))return!1;var b=void 0;for(b in a);return void 0===b||a.hasOwnProperty(b)},removeFromArray:function(a,b){var c=a.indexOf(b);return c>-1&&a.splice(c,1),c},size:function(a){if(null===a)return 0;if(a.length===+a.length)return a.length;var b=0;for(var c in a)a.hasOwnProperty(c)&&b++;return b},regcallback:function(a,b){if(!a||!b||"function"!=typeof a||"function"!=typeof b)return lightapp.error(ErrCode.UNKNOW_INPUT,a,b),!1;var d=this.randomInt(100,200)+Date.now();c.successProxy[d]=a,c.failProxy[d]=b;var e="(function(result){ var randomId = '"+d+"';(",f=")(randomId,result)})";return{s:e+g+f,f:e+h+f}},getWebKitPluginInfo:function(a){return clouda.RUNTIME===clouda.RUNTIMES.KUANG&&clouda.PLATFORM===clouda.PLATFORMS.ANDROID&&clouda.RUNTIME_VERSION>="5.5"?void cloudaBLight("getWebKitPluginInfo",a,a):void("function"==typeof a&&a({result:1}))},setLogStorage:function(a,b){try{var c=localStorage.getItem("cloudaFuncs");if(c)try{c=JSON.parse(c),c[a]||(c[a]={}),c[a][b]||(c[a][b]=0),c[a][b]=c[a][b]+1}catch(d){console.error(d.stack)}else c={},c[a]={},c[a][b]=1;localStorage.setItem("cloudaFuncs",JSON.stringify(c))}catch(d){console.error(d.stack)}},closeWindow:function(){clouda.PLATFORM===clouda.PLATFORMS.IOS?cloudaBLight("closeWindow",function(){},function(){}):cloudaBLight("closeWindow")}};l.setDebugMode(!1),a.utils=l,a.callbackProxy=c});define("mbaas",function(a){var b=this,c=a.account={};new DelegateClass("device","login","login");var d=null;a.LOGIN_TYPE={WEIBO:"sinaweibo",QQ:"qqdenglu",KAIXIN:"kaixin",QQWEIBO:"qqweibo",RENREN:"renren"};var e=!1;c.login=function(a){if(!a.onsuccess||!a.onfail||!a.redirect_uri||"function"!=typeof a.onsuccess||"function"!=typeof a.onfail)return b.error(ErrCode.UNKNOW_INPUT,ErrCode.UNKNOW_INPUT,a),!1;var c={client_id:clouda.lightapp.ak,redirect_uri:a.redirect_uri,scope:a.scope||"basic",login_mode:a.login_mode||0,login_type:a.login_type||void 0,mobile:a.mobile||void 0,display:"mobile",response_type:"code",state:a.state||void 0};if(1===c.login_mode&&(c.confirm_login=1),2===c.login_mode&&(c.force_login=1),c.disable_third_login=0===a.disable_third_login?a.disable_third_login:1,!Boolean(a.force_h5)&&clouda.RUNTIME===clouda.RUNTIMES.KUANG&&BLightApp&&"function"==typeof BLightApp.login){var f=clouda.lib.utils.regcallback(a.onsuccess,a.onfail);BLightApp.login(JSON.stringify(c),f.s,f.f)}else{var g="https://openapi.baidu.com/oauth/2.0/authorize";a.authorize_url&&(g=a.authorize_url);var h=g+"?response_type=code&client_id="+clouda.lightapp.ak+"&redirect_uri="+encodeURIComponent(a.redirect_uri);c.login_mode&&(h+="&login_mode="+c.login_mode),c.login_type&&(h+="&login_type="+c.login_type),c.client_id&&(h+="&client_id="+c.client_id),c.scope&&(h+="&scope="+c.scope),c.state&&(h+="&state="+c.state),c.display&&(h+="&display="+c.display),c.force_login&&(h+="&force_login="+c.force_login),c.confirm_login&&(h+="&confirm_login="+c.confirm_login),c.mobile&&(h+="&mobile="+c.mobile),h+="&return_callback="+encodeURIComponent(location.origin),h+="&disable_third_login="+c.disable_third_login,document.querySelector("#cloudaLoginFrame")?d=document.querySelector("#cloudaLoginFrame"):(d=document.createElement("iframe"),d.id="cloudaLoginFrame"),d.src=h,d.style.position="absolute",d.style.top="0px",d.style.left="0px",d.scrolling="no",d.style.border="none",d.style.backgroundColor="#fff",d.style.display="none",d.style.zIndex="99999",document.body.appendChild(d),e||window.addEventListener("message",function(b){var c=b.data;"return_callback"===c&&(clouda.mbaas.account.closeLoginDialog(),a.onfail()),"show_login"===c&&(d.style.display="block"),e=!0},!1);var i=top.innerWidth>=top.document.body.offsetHeight?top.innerWidth:top.document.body.offsetHeight;d.style.width=top.innerWidth+"px",d.style.height=i+"px",d.onload=function(){d.style.width=top.innerWidth+"px",d.style.height=i+"px"}}},c.closeLoginDialog=function(){d&&document.body.contains(d)&&document.body.removeChild(d)},c.bdLogin=function(a){if(!clouda.STATUS.SUCCESS)return kuangForReady("clouda.mbaas.account.bdLogin",arguments),void 0;if(!a.onsuccess||!a.onfail||"function"!=typeof a.onsuccess||"function"!=typeof a.onfail||!a.tpl)return b.error(ErrCode.UNKNOW_INPUT,ErrCode.UNKNOW_INPUT,a),!1;var c={};if(c.u=a.u?encodeURIComponent(a.u):"",c.uid=a.uid||"",c.regtype=a.regtype||"",c.from=a.from||"",c.bd_page_type=a.bd_page_type||"",c.pu=a.pu||"",c.tn=a.tn||"",c.tpl=a.tpl,c.login_type=a.login_type||"",c.mobile=a.mobile||"",clouda.RUNTIME===clouda.RUNTIMES.KUANG&&BLightApp&&"function"==typeof BLightApp.bdLogin){var d=clouda.lib.utils.regcallback(a.onsuccess,a.onfail);return BLightApp.bdLogin(JSON.stringify(c),d.s,d.f),void 0}var e="http://wappass.baidu.com/passport/",f=e+"?login&u="+c.u+"&uid="+c.uid+"&pu="+c.pu+"&regtype="+c.regtype+"&from="+c.from+"&bd_page_type="+c.bd_page_type+"&tn="+c.tn+"&tpl="+c.tpl;if(a.extra_params){var g=a.extra_params;for(var h in g)g.hasOwnProperty(h)&&(f=f+"&"+h+"="+g[h])}return location.replace(f),void 0},c.checkSupport=function(a){var b={};clouda.RUNTIME===clouda.RUNTIMES.NUWA?b["native"]=0:clouda.RUNTIME===clouda.RUNTIMES.KUANG?b["native"]=BLightApp&&"function"==typeof BLightApp.login?1:0:clouda.RUNTIME===clouda.RUNTIMES.WEB&&(b["native"]=0),b.web=1,a(b)}});})(window);